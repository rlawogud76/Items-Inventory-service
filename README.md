# 마인크래프트 마을 재고 관리 봇

디스코드에서 마인크래프트 마을 재고를 실시간으로 관리하는 봇입니다.

## 🚀 설치 방법

### 1. Node.js 설치
Node.js가 설치되어 있지 않다면 [nodejs.org](https://nodejs.org/)에서 다운로드하세요.

### 2. 패키지 설치
```bash
npm install
```

### 3. 디스코드 봇 생성

1. [Discord Developer Portal](https://discord.com/developers/applications)에 접속
2. "New Application" 클릭하고 봇 이름 입력
3. 왼쪽 메뉴에서 "Bot" 클릭
4. "Reset Token" 클릭해서 토큰 복사 (한 번만 보여집니다!)
5. "MESSAGE CONTENT INTENT" 활성화 (중요!)
6. 왼쪽 메뉴에서 "OAuth2" > "URL Generator" 클릭
7. Scopes에서 "bot" 선택
8. Bot Permissions에서 다음 권한 선택:
   - Send Messages
   - Embed Links
   - Read Message History
9. 생성된 URL로 봇을 서버에 초대

### 4. 환경 변수 설정

`.env.example` 파일을 `.env`로 복사하고 토큰 입력:

```bash
copy .env.example .env
```

`.env` 파일을 열어서 봇 토큰 입력:
```
DISCORD_TOKEN=여기에_복사한_토큰_붙여넣기
CLIENT_ID=여기에_클라이언트_ID_입력
```

### 5. 봇 실행
```bash
npm start
```

## 📝 사용법

### 📦 재고 관리 명령어

**카테고리:** 해양, 채광, 요리

━━━━━━━━━━━━━━━━━━━━

**`/재고 [카테고리]`**
재고 현황을 확인합니다.
> 예: `/재고 카테고리:해양`

**`/재고수량변경`**
아이템의 현재 수량을 변경합니다.
> 예: `/재고수량변경 카테고리:해양 아이템:다이아몬드 수량:50`

**`/재고충족수량변경`**
아이템의 충족 수량을 변경합니다.
> 예: `/재고충족수량변경 카테고리:채광 아이템:철괴 수량:200`

**`/재고목록추가`**
새로운 아이템을 추가합니다.
> 예: `/재고목록추가 카테고리:요리 아이템:금괴 초기수량:20 충족수량:100`

**`/재고목록제거`**
아이템을 제거합니다.
> 예: `/재고목록제거 카테고리:해양 아이템:금괴`

### 🔨 제작 관리 명령어

━━━━━━━━━━━━━━━━━━━━

**`/제작 [카테고리]`**
제작 현황을 확인합니다.
> 예: `/제작 카테고리:해양`

**`/제작수량변경`**
제작품의 현재 수량을 변경합니다.
> 예: `/제작수량변경 카테고리:채광 제작품:곡괭이 수량:5`

**`/제작충족수량변경`**
제작품의 충족 수량을 변경합니다.
> 예: `/제작충족수량변경 카테고리:요리 제작품:빵 수량:10`

**`/제작목록추가`**
새로운 제작품을 추가합니다.
> 예: `/제작목록추가 카테고리:해양 제작품:낚싯대 초기수량:3 충족수량:10`

**`/제작목록제거`**
제작품을 제거합니다.
> 예: `/제작목록제거 카테고리:채광 제작품:곡괭이`

**`/제작초기화`**
제작품 수량을 0으로 초기화합니다 (전체 또는 카테고리별).
> 예: `/제작초기화 카테고리:채광`

**`/제작초기화개별`**
특정 제작품 또는 카테고리 전체를 0으로 초기화합니다.
> 예: `/제작초기화개별 카테고리:채광 제작품:곡괭이`

### 🧪 레시피 관리 명령어

━━━━━━━━━━━━━━━━━━━━

**`/레시피등록`**
제작품에 필요한 재료를 등록합니다 (최대 3개, 같은 카테고리만 가능).
> 예: `/레시피등록 카테고리:채광 제작품:곡괭이 재료1:철괴 재료1수량:3 재료2:나무 재료2수량:2`

**`/레시피확인`**
등록된 레시피와 현재 보유 재료를 확인합니다.
> 예: `/레시피확인 카테고리:채광 제작품:곡괭이`

**`/레시피삭제`**
레시피를 삭제합니다.
> 예: `/레시피삭제 카테고리:채광 제작품:곡괭이`

**💡 레시피 기능:**
- 제작품 추가 시 자동으로 재료 차감
- 재료 부족 시 제작 불가
- 재료는 같은 카테고리에 등록된 아이템만 사용 가능

### 🔄 초기화 명령어

━━━━━━━━━━━━━━━━━━━━

**`/재고초기화`**
재고 아이템을 0으로 초기화합니다.
> 예: `/재고초기화 카테고리:해양` (카테고리 전체)
> 예: `/재고초기화 카테고리:해양 아이템:다이아몬드` (특정 아이템)

**`/제작초기화`**
제작품을 0으로 초기화합니다 (전체 또는 카테고리별).
> 예: `/제작초기화` (전체)
> 예: `/제작초기화 카테고리:채광` (특정 카테고리)

**`/제작초기화개별`**
특정 제작품을 0으로 초기화합니다.
> 예: `/제작초기화개별 카테고리:채광` (카테고리 전체)
> 예: `/제작초기화개별 카테고리:채광 제작품:곡괭이` (특정 제작품)

### 기타 명령어

**`/도움말`** - 봇 사용법 확인
**`/수정내역`** - 재고 및 제작 수정 내역 확인

## ✨ 주요 기능

### 📊 실시간 재고 관리
- 재고 현황을 실시간으로 확인
- 프로그레스 바로 진행률 시각화
- 세트(64개) 단위로 수량 관리

### 👥 작업 관리
- 수집/제작 중인 사람 표시
- 한 명만 작업 가능 (중복 방지)
- 100% 달성 시 자동으로 작업 불가

### 🎨 UI 커스터마이징
- 3가지 UI 모드 (일반/컴팩트/상세)
- 프로그레스 바 크기 조절 (25%~200%)
- 자동 새로고침 기능 (5초 간격)

### 🧪 레시피 시스템
- 제작품별 필요 재료 등록
- 제작 시 자동 재료 차감
- 재료 부족 시 제작 불가 알림

### 📋 수정 내역 추적
- 모든 변경사항 자동 기록
- 누가, 언제, 무엇을 변경했는지 추적
- 최대 100개 내역 보관

### 재고 상태 표시

- 🔴 빨간불: 재고 부족 (25% 이하)
- 🟡 노란불: 재고 보통 (25% 초과 ~ 90% 미만)
- 🟢 초록불: 재고 충분 (90% 이상)

## ⚙️ 재고 아이템 수정

`inventory.json` 파일을 수정해서 관리할 아이템을 추가/제거할 수 있습니다:

```json
{
  "categories": {
    "카테고리이름": {
      "아이템이름": {
        "quantity": 현재수량,
        "required": 충족수량
      }
    }
  }
}
```

## 🎮 예시

```
사용자: /재고 카테고리:해양
봇: 
🏘️ 해양 재고 관리
💎 다이아몬드
현재 수량: 35(0세트) / 충족 수량: 100(1세트)
████████░░░░░░░ 35% 🟡

사용자: /재고수량변경 카테고리:해양 아이템:다이아몬드 수량:100
봇: ✅ 현재 수량 변경 완료
카테고리: 해양
💎 다이아몬드
35개 → 100개
```


## 🚂 Railway 배포 (데이터 유지)

이 봇은 `data.js` 파일에 데이터를 저장합니다. 

### 데이터 유지 방법

1. **봇 사용 중 변경된 데이터를 저장하려면:**
   - Railway Shell 또는 로컬에서 `data.js` 파일 내용 확인
   - 변경사항을 Git에 커밋하고 푸시

2. **Railway Shell에서 데이터 확인:**
   ```bash
   cat data.js
   ```

3. **로컬에서 데이터 백업:**
   ```bash
   git pull
   ```

### 주의사항

- `data.js` 파일은 봇이 실행 중일 때 자동으로 업데이트됩니다
- Railway에서 재배포하면 마지막 Git 커밋 상태로 돌아갑니다
- 중요한 데이터는 정기적으로 Git에 커밋하세요

### 데이터 백업 권장 방법

```bash
# 1. Railway Shell에서 현재 데이터 확인
cat data.js

# 2. 로컬에서 data.js 파일 업데이트
# (Railway Shell 출력 내용을 복사해서 로컬 data.js에 붙여넣기)

# 3. Git에 커밋
git add data.js
git commit -m "데이터 백업"
git push

# 4. Railway에서 자동 재배포됨
```
